// Generated by CoffeeScript 1.6.2
(function() {
  angular.module('habits.controllers', []).controller('Dashboard', function($scope, $http) {
    var fetchData, fetchDataTimer;

    fetchData = function() {
      return $http.get("data.json").success(function(data, status, headers, config) {
        $scope.habits = data;
        return $scope.lastUpdated = new Date();
      }).error(function() {});
    };
    fetchDataTimer = function() {
      fetchData();
      return setTimeout(fetchDataTimer, 60000);
    };
    $scope.toggle = function(service) {
      if (!$scope.habits[service].tappable) {
        return;
      }
      $scope.habits[service].green = !$scope.habits[service].green;
      return $http.get("toggle/" + service + "?_method=put").success(function(data, status, headers, config) {
        return $scope.habits[service] = data;
      }).error(function() {});
    };
    return fetchDataTimer();
  });

}).call(this);
